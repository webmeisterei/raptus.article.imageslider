<div i18n:domain="raptus.article"
     tal:condition="view/images"
     class="imageSliderTeaser">


    <div class="visualNoPrint scrollable"
         tal:define="anonymous context/@@plone_portal_state/anonymous">

        <ul tal:attributes="class string:items manageableList ${view/css_class}">
            <li tal:repeat="item view/images"
                tal:attributes="class string:${item/class}">
                <metal:manage use-macro="context/raptus_article_macros/macros/manage" />
                
                <a tal:omit-tag="python: not view.linkRelatedItems or item['link'] is None"
                   href="#"
                   tal:attributes="href item/link">                
                <span class="img"><img tal:attributes="src item/img_url;
                                           alt item/caption;
                                           width view/width;" /></span>
                
                <span class="caption"
                      tal:condition="python:view.showCaption and item['description']">
                    <span tal:content="structure python:item.get('description').replace('\n', '<br />')" />
                </span>
                </a>
            </li>
        </ul>
    </div>
    <div class="navi" tal:condition="view/showNav"></div>
    <tal:js tal:replace='structure string:&lt;script type="text/javascript" &gt;' />
    $(function() {
        setTimeout(function(){
            // circular:true leads to overlapping images when not wrapped by the timeout

            var circular = $('.scrollable .items li').length > 1;
            var api = $('.scrollable').scrollable({
                circular: circular,
                speed: <tal:value replace="view/fadeTime" />
            });

            if (circular == true) {
                api.autoscroll({interval: <tal:value replace="view/haltTime" />, autopause: false}).navigator();
            }
        }, 1);
    });
    <tal:js tal:replace='structure string:&lt;/script&gt;' />

</div>
